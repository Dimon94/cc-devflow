# Quickstart: REQ-003 分支命名优化

## 环境准备

### 1. 检查 Python3

```bash
python3 --version
# 要求: Python 3.8+
```

### 2. 安装 pypinyin (可选但推荐)

```bash
pip install pypinyin
# 或
pip3 install pypinyin
```

### 3. 验证安装

```bash
python3 -c "from pypinyin import lazy_pinyin; print(lazy_pinyin('测试'))"
# 期望输出: ['ce', 'shi']
```

---

## 开发命令

### 运行测试

```bash
# 全量测试
bats tests/slugify.bats

# 单个测试
bats tests/slugify.bats --filter "chinese"
```

### 手动验证

```bash
# 加载函数
source .claude/scripts/common.sh

# 测试中文转换
slugify "用户登录功能"
# 期望: yong-hu-deng-lu-gong-neng

# 测试英文兼容
slugify "User Login"
# 期望: user-login

# 测试混合输入
slugify "OAuth2认证"
# 期望: oauth2-ren-zheng
```

---

## 测试矩阵

| 测试场景 | 命令 | 期望结果 |
|----------|------|----------|
| 纯中文 | `slugify "用户登录"` | `yong-hu-deng-lu` |
| 中英混合 | `slugify "OAuth2认证"` | `oauth2-ren-zheng` |
| 多音字 | `slugify "重庆"` | `chong-qing` |
| 特殊字符 | `slugify "测试@功能"` | `ce-shi-gong-neng` |
| 纯英文 | `slugify "User Login"` | `user-login` |
| 空输入 | `slugify ""` | `` |

---

## 验证步骤

### Step 1: 功能验证

```bash
source .claude/scripts/common.sh

# 验证核心功能
[[ $(slugify "用户登录") == "yong-hu-deng-lu" ]] && echo "PASS" || echo "FAIL"
```

### Step 2: 兼容性验证

```bash
# 验证英文行为不变
[[ $(slugify "User Login") == "user-login" ]] && echo "PASS" || echo "FAIL"
```

### Step 3: 降级验证 (可选)

```bash
# 临时移除 pypinyin
pip uninstall pypinyin -y

# 验证警告输出
slugify "中文" 2>&1 | grep -q "Warning" && echo "WARNING_WORKS" || echo "FAIL"

# 恢复 pypinyin
pip install pypinyin
```

---

## 集成测试

### 使用 /flow-init 创建需求

```bash
# 测试完整流程
.claude/scripts/create-requirement.sh "REQ-TEST" "用户认证功能"

# 验证分支名
git branch | grep "yong-hu-ren-zheng"
```

---

## Troubleshooting

| 问题 | 解决方案 |
|------|----------|
| `command not found: python3` | 安装 Python3 |
| `ModuleNotFoundError: pypinyin` | 运行 `pip install pypinyin` |
| 中文变成空字符串 | 检查 pypinyin 安装，查看 stderr 警告 |
| 测试失败 | 检查 locale 设置 `export LC_ALL=en_US.UTF-8` |

---

**Generated by**: tech-architect agent
**Reference**: TECH_DESIGN.md Section 6
