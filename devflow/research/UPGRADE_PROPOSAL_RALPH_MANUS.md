# CC-DevFlow å‡çº§æ–¹æ¡ˆï¼šRalph Ã— Manus èåˆ v2.0

> **ç‰ˆæœ¬**: 2.0.0
> **æ—¥æœŸ**: 2026-01-08
> **çŠ¶æ€**: ä¿®è®¢ç‰ˆï¼ˆåŸºäºç”¨æˆ·åé¦ˆï¼‰
> **ä½œè€…**: Claude Opus 4.5

---

## ä¿®è®¢æ‘˜è¦

åŸºäºåé¦ˆï¼Œv2 æ–¹æ¡ˆåšäº†ä»¥ä¸‹è°ƒæ•´ï¼š

| åŸæ–¹æ¡ˆ (v1) | ä¿®è®¢å (v2) | åŸå›  |
|-------------|-------------|------|
| æ–°å¢ TASK_PLAN.md | âŒ åˆ é™¤ | ä¸ TASKS.md + EXECUTION_LOG.md é‡å¤ |
| æ–°å¢ RESEARCH_NOTES.md | âŒ åˆ é™¤ | ä¸ research/ ç›®å½•é‡å¤ |
| ERRORS.md | âœ… æ”¹å ERROR_LOG.md | å‘½åä¸€è‡´æ€§ |
| Planning-with-files ç‹¬ç«‹ç³»ç»Ÿ | âœ… èå…¥ç°æœ‰ç»“æ„ | åœ¨ research/ é‡ŒæŒ‰ Manus æ–¹æ³•è®°å½• |

**æ ¸å¿ƒä¿ç•™**:
1. **Ralph å¾ªç¯æœºåˆ¶** - Stop Hook è‡ªåŠ¨è¿­ä»£
2. **æ³¨æ„åŠ›åˆ·æ–°åè®®** - å…³é”®ï¼éœ€æ·±å…¥è®¾è®¡
3. **ERROR_LOG.md** - å”¯ä¸€æ–°å¢çš„æ ¸å¿ƒæ–‡ä»¶

---

## ä¸€ã€ä¸¤å¤§ç³»ç»Ÿæ ¸å¿ƒåˆ†æ

### 1.1 Planning-With-Files (Manus é£æ ¼)

**æ ¸å¿ƒç†å¿µ**: æ–‡ä»¶ç³»ç»Ÿ = æ— é™å¤–éƒ¨è®°å¿†

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MANUS å…­å¤§åŸåˆ™                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. æ–‡ä»¶ç³»ç»Ÿä½œå¤–éƒ¨è®°å¿†  â†’  ä¸å¡æ»¡ä¸Šä¸‹æ–‡ï¼Œå­˜åˆ°æ–‡ä»¶é‡Œ            â”‚
â”‚ 2. æ³¨æ„åŠ›æ“çºµ         â†’  æ¯æ¬¡å†³ç­–å‰é‡è¯»å…³é”®æ–‡ä»¶               â”‚
â”‚ 3. ä¿ç•™å¤±è´¥ç—•è¿¹       â†’  é”™è¯¯æ˜¯å­¦ä¹ æ•°æ®ï¼Œä¸è¦éšè—             â”‚
â”‚ 4. é¿å…å°‘æ ·æœ¬è¿‡æ‹Ÿåˆ   â†’  å¼•å…¥å—æ§å˜åŒ–ï¼Œé¿å…é‡å¤æ¨¡å¼           â”‚
â”‚ 5. ç¨³å®šå‰ç¼€ä¼˜åŒ–ç¼“å­˜   â†’  é™æ€å†…å®¹æ”¾å‰é¢ï¼Œæœ€å¤§åŒ– KV-cache å‘½ä¸­ â”‚
â”‚ 6. åªè¿½åŠ ä¸Šä¸‹æ–‡       â†’  æ°¸ä¸ä¿®æ”¹å†å²æ¶ˆæ¯ï¼Œåªè¿½åŠ æ–°ä¿¡æ¯       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**CC-DevFlow å·²æœ‰çš„å¯¹åº”æœºåˆ¶**:

| Manus åŸåˆ™ | CC-DevFlow ç°æœ‰æœºåˆ¶ | éœ€è¦å¢å¼ºçš„ |
|------------|---------------------|------------|
| æ–‡ä»¶ç³»ç»Ÿä½œå¤–éƒ¨è®°å¿† | research/ ç›®å½• âœ… | - |
| æ³¨æ„åŠ›æ“çºµ | Brainstorm Alignment Check | **éœ€è¦æ‰©å±•åˆ°æ›´å¤šè§¦å‘ç‚¹** |
| ä¿ç•™å¤±è´¥ç—•è¿¹ | EXECUTION_LOG.md | **éœ€è¦ç»“æ„åŒ–é”™è¯¯æ—¥å¿—** |
| é¿å…å°‘æ ·æœ¬è¿‡æ‹Ÿåˆ | - | ç ”ç©¶è®°å½•è§„èŒƒ |
| ç¨³å®šå‰ç¼€ä¼˜åŒ–ç¼“å­˜ | æ¨¡æ¿ç³»ç»Ÿ | - |
| åªè¿½åŠ ä¸Šä¸‹æ–‡ | - | ç ”ç©¶è®°å½•è§„èŒƒ |

### 1.2 Ralph-Wiggum (è‡ªå¼•ç”¨è¿­ä»£å¾ªç¯)

**æ ¸å¿ƒç†å¿µ**: æŒç»­è¿­ä»£ç›´åˆ°å®Œæˆï¼Œæ°¸ä¸æ”¾å¼ƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   RALPH å¾ªç¯æœºåˆ¶                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚   â”‚ ç”¨æˆ·è¿è¡Œ â”‚â”€â”€â”€â–¶â”‚ Claude  â”‚â”€â”€â”€â–¶â”‚ å°è¯•é€€å‡º    â”‚          â”‚
â”‚   â”‚ /ralph  â”‚    â”‚ å·¥ä½œ    â”‚    â”‚             â”‚          â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                        â”‚                  â”‚
â”‚                                        â–¼                  â”‚
â”‚                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚                               â”‚ Stop Hook æ‹¦æˆª  â”‚        â”‚
â”‚                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                        â”‚                  â”‚
â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚                   â”‚ æœªå®Œæˆ              â”‚ å·²å®Œæˆ         â”‚â”‚
â”‚                   â–¼                    â–¼                â”‚â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚â”‚
â”‚           â”‚ é‡æ–°æ³¨å…¥     â”‚      â”‚ å…è®¸é€€å‡º    â”‚         â”‚â”‚
â”‚           â”‚ ç›¸åŒ Prompt  â”‚      â”‚ ä»»åŠ¡ç»“æŸ    â”‚         â”‚â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚â”‚
â”‚                  â”‚                                      â”‚â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ ç»§ç»­å·¥ä½œ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å…³é”®ç‰¹æ€§**:
- æç¤ºä¸å˜ï¼Œæ–‡ä»¶çŠ¶æ€å˜åŒ–
- Claude ä»è‡ªå·±çš„å‰ä½œä¸­å­¦ä¹ 
- completion-promise ä½œä¸ºé€€å‡ºä¿¡å·
- max-iterations ä½œä¸ºå®‰å…¨é˜€

### 1.3 ä¸ºä»€ä¹ˆæ˜¯"ç»é…"ï¼Ÿ

```
Planning-With-Files          Ralph-Wiggum
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ "è®¤çœŸæŠŠè¿›åº¦è®°ä¸‹æ¥" â”‚         â”‚ "ç›‘ç£æŠŠæ´»å¹²å®Œ"    â”‚
â”‚                 â”‚         â”‚                 â”‚
â”‚ â€¢ ç»“æ„åŒ–è¿½è¸ª     â”‚   Ã—     â”‚ â€¢ æŒç»­æ‰§è¡Œå‹åŠ›   â”‚
â”‚ â€¢ æ³¨æ„åŠ›åˆ·æ–°     â”‚         â”‚ â€¢ è‡ªåŠ¨è¿­ä»£æ”¹è¿›   â”‚
â”‚ â€¢ çŸ¥è¯†æŒä¹…åŒ–     â”‚         â”‚ â€¢ ä¸è¾¾ç›®çš„ä¸é€€å‡º â”‚
â”‚ â€¢ é”™è¯¯æ—¥å¿—      â”‚         â”‚ â€¢ è‡ªæˆ‘ä¿®æ­£èƒ½åŠ›   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                           â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ æœ‰è®°å¿†çš„æŒç»­è¿­ä»£ç³»ç»Ÿ  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## äºŒã€æ³¨æ„åŠ›åˆ·æ–°åè®® (æ ¸å¿ƒè®¾è®¡)

### 2.1 é—®é¢˜åˆ†æ

**Lost in the Middle æ•ˆåº”**:

```
ä¸Šä¸‹æ–‡å¼€å§‹: [åŸå§‹ç›®æ ‡ - è·ç¦»å¾ˆè¿œï¼Œè¢«"é—å¿˜"]
     â†“
... 50+ å·¥å…·è°ƒç”¨ ...
     â†“
ä¸Šä¸‹æ–‡æœ«å°¾: [æœ€è¿‘çš„å·¥å…·è¾“å‡º - åœ¨æ³¨æ„åŠ›çª—å£]

é—®é¢˜: åŸå§‹ç›®æ ‡å·²è¢«"æ¨å‡º"æ³¨æ„åŠ›çª—å£
```

**è§£å†³æ–¹æ¡ˆ**: åœ¨å…³é”®æ—¶åˆ»å¼ºåˆ¶è¯»å–ç›®æ ‡æ–‡æ¡£ï¼Œå°†ç›®æ ‡"æ‹‰å›"æ³¨æ„åŠ›çª—å£

### 2.2 è§¦å‘æ—¶æœºè®¾è®¡

| è§¦å‘ç‚¹ | è¯»å–å†…å®¹ | ç°æœ‰ä½ç½® | åŠ¨ä½œ |
|--------|----------|----------|------|
| **æ¯ä¸ª flow-* Entry Gate** | BRAINSTORM.md | Brainstorm Alignment Check âœ… | ä¿æŒ |
| **flow-dev æ¯ä¸ªä»»åŠ¡å¼€å§‹** | TASKS.md å½“å‰ä»»åŠ¡æ®µè½ | æ—  | **æ–°å¢** |
| **Ralph æ¯æ¬¡è¿­ä»£å¼€å§‹** | TASKS.md + ERROR_LOG.md | æ—  | **æ–°å¢** |
| **é‡åˆ°é”™è¯¯åæ¢å¤** | ERROR_LOG.md ç›¸å…³è®°å½• | æ—  | **æ–°å¢** |

### 2.3 å®ç°ä½ç½®

**æ–¹æ¡ˆ**: åˆ›å»º `flow-attention-refresh` skillï¼Œè¢«å…¶ä»– flow å‘½ä»¤å¼•ç”¨

**ä½ç½®**: `.claude/skills/flow-attention-refresh/SKILL.md`

```markdown
---
name: flow-attention-refresh
description: "æ³¨æ„åŠ›åˆ·æ–°åè®®ã€‚åœ¨å…³é”®æ—¶åˆ»å¼ºåˆ¶è¯»å–æ ¸å¿ƒæ–‡æ¡£ï¼Œé˜²æ­¢ç›®æ ‡é—å¿˜ã€‚"
---

# Flow Attention Refresh

## The Iron Law

```
BEFORE MAJOR DECISION â†’ READ GOAL FILES â†’ THEN ACT
```

## Refresh Protocol

### Protocol 1: Flow Entry
æ¯ä¸ª flow-* å‘½ä»¤å¼€å§‹æ—¶:
```yaml
read:
  - BRAINSTORM.md "æˆåŠŸæ ‡å‡†" ç« èŠ‚
  - TASKS.md å½“å‰é˜¶æ®µä»»åŠ¡åˆ—è¡¨
focus: æœ¬æ¬¡å‘½ä»¤è¦è¾¾æˆä»€ä¹ˆï¼Ÿ
```

### Protocol 2: Task Start
flow-dev æ¯ä¸ªä»»åŠ¡å¼€å§‹å‰:
```yaml
read:
  - TASKS.md T### è¡Œ + DoD
  - quickstart.md ç›¸å…³å‘½ä»¤
focus: è¿™ä¸ªä»»åŠ¡çš„éªŒæ”¶æ ‡å‡†æ˜¯ä»€ä¹ˆï¼Ÿ
```

### Protocol 3: Ralph Iteration
Ralph å¾ªç¯æ¯æ¬¡è¿­ä»£å¼€å§‹:
```yaml
read:
  - TASKS.md ç¬¬ä¸€ä¸ªæœªå®Œæˆä»»åŠ¡
  - ERROR_LOG.md æœ€è¿‘ 5 æ¡
focus: ä¸‹ä¸€æ­¥è¡ŒåŠ¨ + é¿å…é‡å¤é”™è¯¯
```

### Protocol 4: Error Recovery
é‡åˆ°é”™è¯¯å:
```yaml
read:
  - ERROR_LOG.md å½“å‰é”™è¯¯
  - TASKS.md å½“å‰ä»»åŠ¡
focus: é”™è¯¯æ ¹å›  + è§£å†³æ–¹æ¡ˆ
```
```

### 2.4 ä¸ç°æœ‰æœºåˆ¶çš„æ•´åˆ

```
ç°æœ‰: flow-brainstorming skill
        â†“ è§¦å‘äº /flow-init
        â†“ è¾“å‡º BRAINSTORM.md

ç°æœ‰: Brainstorm Alignment Check
        â†“ åœ¨æ¯ä¸ª flow-* Entry Gate
        â†“ è¯»å– BRAINSTORM.md éªŒè¯å¯¹é½

æ–°å¢: flow-attention-refresh skill
        â†“ è¢« flow-dev, flow-ralph å¼•ç”¨
        â†“ åœ¨æ›´ç»†ç²’åº¦çš„æ—¶åˆ»åˆ·æ–°æ³¨æ„åŠ›
```

**ä¿®æ”¹ flow-dev.md**:

```diff
### é˜¶æ®µ 3: TDD å¾ªç¯
```
For each remaining task (é¡ºåºä¸¥æ ¼éµå¾ª TASKS.md):

+ **æ³¨æ„åŠ›åˆ·æ–°** (å‚è§ {SKILL:attention-refresh} Protocol 2):
+ â†’ Read: TASKS.md å½“å‰ä»»åŠ¡ T### æ®µè½
+ â†’ Focus: ä»»åŠ¡ç›®æ ‡å’Œ DoD

1. è¯»å–ä»»åŠ¡å®šä¹‰
   â†’ æå– task idã€phaseã€æ–‡ä»¶è·¯å¾„ã€æ˜¯å¦ [P]
...
```

---

## ä¸‰ã€Planning-with-files èå…¥ research/

### 3.1 è®¾è®¡åŸåˆ™

**ä¸æ–°å»ºæ–‡ä»¶ï¼Œå¢å¼ºç°æœ‰ç»“æ„**

Planning-with-files çš„æ ¸å¿ƒä¸æ˜¯"ä¸‰æ–‡ä»¶æ¨¡å¼"ï¼Œè€Œæ˜¯**ç ”ç©¶æ–¹æ³•è®º**:
1. å¤§å†…å®¹å­˜æ–‡ä»¶ï¼Œä¸Šä¸‹æ–‡ä¿æŒç²¾ç®€
2. å†³ç­–å‰è¯»å–ï¼Œåˆ·æ–°ç›®æ ‡
3. å¤±è´¥ç•™ç—•è¿¹ï¼Œé¿å…é‡å¤

### 3.2 èå…¥ç‚¹

**ç°æœ‰ research/ ç»“æ„**:
```
research/
â”œâ”€â”€ internal/
â”‚   â””â”€â”€ codebase-overview.md      # ä»£ç åº“åˆ†æ
â”œâ”€â”€ mcp/
â”‚   â””â”€â”€ $(date)/
â”‚       â”œâ”€â”€ official/             # å®˜æ–¹æ–‡æ¡£
â”‚       â”œâ”€â”€ guides/               # æŒ‡å—
â”‚       â”œâ”€â”€ tutorials/            # æ•™ç¨‹
â”‚       â””â”€â”€ examples/             # ç¤ºä¾‹
â”œâ”€â”€ research.md                   # å†³ç­–æ±‡æ€» â† Manus æ³¨æ„åŠ›åˆ·æ–°ç›®æ ‡
â”œâ”€â”€ research-summary.md           # ç ”ç©¶æ€»ç»“
â””â”€â”€ tasks.json                    # ç ”ç©¶ä»»åŠ¡
```

**Manus æ–¹æ³•èå…¥**:

| Manus è¡Œä¸º | èå…¥ç‚¹ | å®ç°æ–¹å¼ |
|------------|--------|----------|
| å¤§å†…å®¹å­˜æ–‡ä»¶ | research/mcp/ | å·²æ»¡è¶³ |
| å†³ç­–å‰è¯»å– | research.md | æ¯æ¬¡åšå†³ç­–å‰è¯»å– Decisions ç« èŠ‚ |
| å¤±è´¥ç•™ç—•è¿¹ | research/attempts/ (æ–°å¢å­ç›®å½•) | è®°å½•å¤±è´¥å°è¯• |
| å¢é‡è¿½åŠ  | æ‰€æœ‰ research æ–‡ä»¶ | append è€Œé rewrite |

### 3.3 æ–°å¢ research/attempts/ å­ç›®å½•

**ç”¨é€”**: è®°å½•ç ”ç©¶é˜¶æ®µçš„å¤±è´¥å°è¯•ï¼ˆåŒºåˆ«äº ERROR_LOG.md çš„æ‰§è¡Œé”™è¯¯ï¼‰

```
research/
â””â”€â”€ attempts/                     # [æ–°å¢]
    â”œâ”€â”€ 001-graphql-approach.md   # å°è¯• GraphQLï¼Œå›  X æ”¾å¼ƒ
    â””â”€â”€ 002-rest-pagination.md    # å°è¯•åç§»åˆ†é¡µï¼Œæ”¹ç”¨æ¸¸æ ‡
```

**æ¨¡æ¿**:
```markdown
# Attempt: [æ–¹æ¡ˆå]

**Date**: 2026-01-08
**Context**: è§£å†³ [ä»€ä¹ˆé—®é¢˜]

## Approach
[æè¿°å°è¯•çš„æ–¹æ¡ˆ]

## Result
âŒ å¤±è´¥ / âš ï¸ éƒ¨åˆ†æˆåŠŸ / ğŸ”„ æ”¾å¼ƒ

## Reason
[ä¸ºä»€ä¹ˆä¸è¡Œ]

## Learning
[ä¸‹æ¬¡åº”è¯¥æ³¨æ„ä»€ä¹ˆ]

## References
- [ç›¸å…³æ–‡æ¡£é“¾æ¥]
```

### 3.4 Planning-with-files Skill è§¦å‘æ—¶æœº

**æœ€ä½³è§¦å‘ç‚¹**: `/flow-init` Stage 2.5 Research é˜¶æ®µ

**åŸå› **:
1. è¿™æ˜¯ä¿¡æ¯æ”¶é›†æœ€å¯†é›†çš„é˜¶æ®µ
2. éœ€è¦ç»“æ„åŒ–è®°å½•ç ”ç©¶å‘ç°
3. ç ”ç©¶å†³ç­–éœ€è¦å¯è¿½æº¯æ€§

**ä¿®æ”¹ flow-init.md Stage 2.5**:

```diff
### Stage 2.5: Research (MCP Mandatory Flow)

**ç›®æ ‡**: æ”¶é›†"çœŸå®ææ–™"ï¼Œæ‰€æœ‰æ­¥éª¤ **MANDATORY**

+ **Manus ç ”ç©¶æ–¹æ³•** (å‚è§ planning-with-files skill):
+
+ 1. **å¤§å†…å®¹å­˜æ–‡ä»¶**
+    â†’ æŠ“å–çš„æ–‡æ¡£å­˜ research/mcp/
+    â†’ ä¸Šä¸‹æ–‡åªä¿ç•™è·¯å¾„å¼•ç”¨
+
+ 2. **å†³ç­–å‰è¯»å–**
+    â†’ æ¯æ¬¡åšç ”ç©¶å†³ç­–å‰ï¼Œå…ˆè¯» research/research.md Decisions ç« èŠ‚
+    â†’ ç¡®ä¿ä¸é‡å¤å·²æœ‰å†³ç­–
+
+ 3. **å¤±è´¥å°è¯•è®°å½•**
+    â†’ ç ”ç©¶ä¸­æ”¾å¼ƒçš„æ–¹æ¡ˆå†™å…¥ research/attempts/
+    â†’ è¯´æ˜æ”¾å¼ƒåŸå› å’Œå­¦ä¹ 
+
+ 4. **å¢é‡è¿½åŠ **
+    â†’ ä½¿ç”¨ append è€Œé rewrite
+    â†’ ä¿æŒç ”ç©¶å†å²å®Œæ•´

S0: Internal Codebase Research (å¿…éœ€)
...
```

---

## å››ã€ERROR_LOG.md è®¾è®¡

### 4.1 ä½ç½®ä¸å®šä½

**ä½ç½®**: `devflow/requirements/${REQ_ID}/ERROR_LOG.md`

**å®šä½**:
- è®°å½•**æ‰§è¡Œé˜¶æ®µ**çš„é”™è¯¯ï¼ˆflow-dev, flow-qa ç­‰ï¼‰
- ä¸ research/attempts/ äº’è¡¥ï¼ˆåè€…è®°å½•**ç ”ç©¶é˜¶æ®µ**çš„å¤±è´¥å°è¯•ï¼‰
- ç»“æ„åŒ–æ ¼å¼ï¼Œä¾¿äº Ralph å¾ªç¯è¯»å–å’Œå­¦ä¹ 

### 4.2 æ¨¡æ¿

```markdown
# Error Log: ${REQ_ID}

> æœ¬æ–‡ä»¶è®°å½•éœ€æ±‚å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°çš„æ‰€æœ‰é”™è¯¯åŠè§£å†³æ–¹æ¡ˆã€‚
> **[PROTOCOL]**: é‡åˆ°é”™è¯¯æ—¶ç«‹å³è¿½åŠ ï¼Œä¸è¦ç­‰åˆ°æœ€åã€‚

---

## [2026-01-08T10:30:00] E001: Test Failure

**Phase**: flow-dev / T003
**Error Type**: Test Failure
**Error Message**:
```
FAIL src/auth/login.test.ts
  Ã— should validate email format
    Expected: true
    Received: false
```

**Root Cause**: æ­£åˆ™è¡¨è¾¾å¼æœªå¤„ç† + å·é‚®ç®±
**Resolution**: æ›´æ–°æ­£åˆ™ä¸º `/^[^\s@]+@[^\s@]+\.[^\s@]+$/`
**Prevention**: æ·»åŠ  + å·é‚®ç®±åˆ°æµ‹è¯•ç”¨ä¾‹

---

## [2026-01-08T11:15:00] E002: Build Error
...
```

### 4.3 è§¦å‘æ–¹å¼

**æ–¹å¼ 1**: åœ¨ flow-tdd skill ä¸­åµŒå…¥

```markdown
## Error Recording Protocol

When test fails or build error occurs:

1. Capture error (type, message, context)
2. Append to ERROR_LOG.md:
   ```
   ## [${TIMESTAMP}] E###: ${TITLE}
   **Phase**: ${PHASE}
   **Error Type**: ${TYPE}
   **Error Message**: ...
   **Root Cause**: [åˆ†æåå¡«å†™]
   **Resolution**: [è§£å†³åå¡«å†™]
   ```
3. Continue debugging with error context in mind
```

**æ–¹å¼ 2**: è¾…åŠ©è„šæœ¬ `.claude/scripts/log-error.sh`

```bash
#!/bin/bash
# ç”¨æ³•: log-error.sh "${REQ_DIR}" "Test Failure" "error message"
```

---

## äº”ã€Ralph å¾ªç¯é›†æˆ

### 5.1 /flow-ralph å‘½ä»¤

**ä½ç½®**: `.claude/commands/flow-ralph.md`

```yaml
---
name: flow-ralph
description: 'Start autonomous Ralph loop. Usage: /flow-ralph "REQ-123" [--max-iterations N]'
scripts:
  prereq: .claude/scripts/check-prerequisites.sh
  check_tasks: .claude/scripts/check-task-status.sh
skills:
  attention: .claude/skills/flow-attention-refresh/SKILL.md
  tdd: .claude/skills/flow-tdd/SKILL.md
---
```

**æ‰§è¡Œæµç¨‹**:

```
1. Entry Gate
   â†’ éªŒè¯ TASKS.md å­˜åœ¨
   â†’ åˆ›å»º ERROR_LOG.md (å¦‚ä¸å­˜åœ¨)
   â†’ åˆå§‹åŒ– Ralph çŠ¶æ€

2. Ralph Loop (for i in 1..max_iterations)
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ a. æ³¨æ„åŠ›åˆ·æ–° (Protocol 3)               â”‚
   â”‚    â†’ Read TASKS.md ç¬¬ä¸€ä¸ªæœªå®Œæˆä»»åŠ¡       â”‚
   â”‚    â†’ Read ERROR_LOG.md æœ€è¿‘ 5 æ¡          â”‚
   â”‚                                          â”‚
   â”‚ b. æ‰§è¡Œä»»åŠ¡ (TDD æ–¹å¼)                    â”‚
   â”‚    â†’ éµå¾ª flow-tdd skill                 â”‚
   â”‚                                          â”‚
   â”‚ c. é”™è¯¯å¤„ç†                              â”‚
   â”‚    â†’ å¤±è´¥ â†’ è®°å½• ERROR_LOG.md â†’ ç»§ç»­ä¿®å¤  â”‚
   â”‚                                          â”‚
   â”‚ d. å®Œæˆæ£€æŸ¥                              â”‚
   â”‚    â†’ æ‰€æœ‰ä»»åŠ¡å®Œæˆ? â†’ è¾“å‡º RALPH_COMPLETE  â”‚
   â”‚    â†’ å¦åˆ™ â†’ ç»§ç»­ä¸‹ä¸€è¿­ä»£                  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

3. Exit Gate
   â†’ å®Œæˆ â†’ è¾“å‡º "RALPH_COMPLETE"
   â†’ è¾¾åˆ°ä¸Šé™ â†’ è¾“å‡ºçŠ¶æ€æŠ¥å‘Š
```

### 5.2 ä¸ /flow-dev çš„åŒºåˆ«

| | /flow-dev | /flow-ralph |
|--|-----------|-------------|
| é€€å‡ºæ¡ä»¶ | ä»»åŠ¡å¤±è´¥å¯åœæ­¢ | è¿­ä»£ç›´åˆ°å®Œæˆæˆ–ä¸Šé™ |
| é”™è¯¯å¤„ç† | æç¤ºç”¨æˆ·ä¿®å¤ | è‡ªåŠ¨é‡è¯• |
| æ³¨æ„åŠ›åˆ·æ–° | æ¯ä»»åŠ¡ä¸€æ¬¡ | æ¯è¿­ä»£åˆ·æ–°ï¼ˆå«é”™è¯¯å­¦ä¹ ï¼‰ |
| é€‚ç”¨åœºæ™¯ | éœ€è¦äººå·¥ç›‘ç£ | å¯æ— äººå€¼å®ˆ |
| ERROR_LOG | å¯é€‰è®°å½• | å¼ºåˆ¶è®°å½• |

---

## å…­ã€æ–‡ä»¶ç»“æ„å˜æ›´

### 6.1 æ–°å¢æ–‡ä»¶

```
.claude/
â”œâ”€â”€ commands/
â”‚   â””â”€â”€ flow-ralph.md                    â† [æ–°å¢] Ralph å¾ªç¯å‘½ä»¤
â”œâ”€â”€ skills/
â”‚   â””â”€â”€ flow-attention-refresh/
â”‚       â””â”€â”€ SKILL.md                     â† [æ–°å¢] æ³¨æ„åŠ›åˆ·æ–°åè®®
â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ ralph-stop-hook.sh               â† [æ–°å¢/å¤åˆ¶] Stop Hook
â””â”€â”€ docs/
    â””â”€â”€ templates/
        â””â”€â”€ ERROR_LOG_TEMPLATE.md        â† [æ–°å¢] é”™è¯¯æ—¥å¿—æ¨¡æ¿

devflow/requirements/${REQ_ID}/
â”œâ”€â”€ ERROR_LOG.md                         â† [æ–°å¢] ç»“æ„åŒ–é”™è¯¯æ—¥å¿—
â””â”€â”€ research/
    â””â”€â”€ attempts/                        â† [æ–°å¢] å¤±è´¥å°è¯•è®°å½•
```

### 6.2 ä¿®æ”¹æ–‡ä»¶

```
.claude/commands/flow-init.md            â† Stage 2.5 å¢åŠ  Manus æ–¹æ³•
.claude/commands/flow-dev.md             â† TDD å¾ªç¯å¢åŠ æ³¨æ„åŠ›åˆ·æ–°
.claude/skills/flow-tdd/SKILL.md         â† å¢åŠ é”™è¯¯è®°å½•é€»è¾‘
.claude/skills/cc-devflow-orchestrator/SKILL.md  â† è¯†åˆ« /flow-ralph
```

### 6.3 ä¿æŒä¸å˜

```
devflow/requirements/${REQ_ID}/
â”œâ”€â”€ TASKS.md                             â† [ä¿æŒ] ä»»åŠ¡å®šä¹‰ï¼Œä¸æ–°å¢ task_plan
â”œâ”€â”€ EXECUTION_LOG.md                     â† [ä¿æŒ] æ‰§è¡Œæ—¥å¿—
â”œâ”€â”€ orchestration_status.json            â† [ä¿æŒ] çŠ¶æ€æœº
â””â”€â”€ research/
    â”œâ”€â”€ research.md                      â† [ä¿æŒ] æŒ‰ Manus æ–¹æ³•ä½¿ç”¨
    â””â”€â”€ ...
```

---

## ä¸ƒã€å®æ–½è·¯çº¿å›¾

### Phase 1: æ³¨æ„åŠ›åˆ·æ–°åè®® (Day 1)

- [ ] åˆ›å»º `.claude/skills/flow-attention-refresh/SKILL.md`
- [ ] ä¿®æ”¹ `flow-dev.md` åœ¨ TDD å¾ªç¯ä¸­åµŒå…¥åˆ·æ–°ç‚¹
- [ ] éªŒè¯ç°æœ‰ Brainstorm Alignment Check å·¥ä½œæ­£å¸¸

### Phase 2: ERROR_LOG.md (Day 1-2)

- [ ] åˆ›å»º `ERROR_LOG_TEMPLATE.md`
- [ ] ä¿®æ”¹ `flow-tdd` skill å¢åŠ é”™è¯¯è®°å½•
- [ ] æµ‹è¯•é”™è¯¯è®°å½•æµç¨‹

### Phase 3: /flow-ralph å‘½ä»¤ (Day 2-3)

- [ ] åˆ›å»º `flow-ralph.md` å‘½ä»¤å®šä¹‰
- [ ] å¤åˆ¶/é€‚é… ralph-stop-hook.sh
- [ ] æ›´æ–° cc-devflow-orchestrator è¯†åˆ«æ–°å‘½ä»¤
- [ ] é›†æˆ Stop Hook

### Phase 4: Manus æ–¹æ³•èå…¥ (Day 3)

- [ ] ä¿®æ”¹ `flow-init.md` Stage 2.5
- [ ] åˆ›å»º `research/attempts/` æ¨¡æ¿
- [ ] æ›´æ–° planning-with-files skill è§¦å‘é€»è¾‘

### Phase 5: æµ‹è¯•ä¸æ–‡æ¡£ (Day 4)

- [ ] ç«¯åˆ°ç«¯æµ‹è¯•: å®Œæ•´éœ€æ±‚æµç¨‹ + Ralph æ¨¡å¼
- [ ] å‹åŠ›æµ‹è¯•: é•¿æ—¶é—´è¿­ä»£åœºæ™¯
- [ ] æ›´æ–° CLAUDE.md æ¶æ„æ–‡æ¡£

---

## å…«ã€æˆåŠŸæŒ‡æ ‡

| æŒ‡æ ‡ | å½“å‰åŸºçº¿ | ç›®æ ‡å€¼ |
|------|----------|--------|
| ä»»åŠ¡å®Œæˆç‡ (æ— äººå·¥å¹²é¢„) | ~60% | â‰¥85% |
| æµ‹è¯•å¤±è´¥åè‡ªåŠ¨æ¢å¤ç‡ | 0% | â‰¥70% |
| ä¸Šä¸‹æ–‡é—å¿˜å¯¼è‡´çš„è¿”å·¥ | æ¯éœ€æ±‚ 2-3 æ¬¡ | â‰¤0.5 æ¬¡ |
| é”™è¯¯é‡å¤å‘ç”Ÿç‡ | æœªè¿½è¸ª | â‰¤10% |

---

## ä¹ã€ç»“è®º

### v2 æ–¹æ¡ˆæ ¸å¿ƒä»·å€¼

```
v1: æ–°å¢æ–‡ä»¶ (task_plan.md, notes.md) â†’ ä¸ç°æœ‰ç»“æ„å†²çª
    â†“
v2: èå…¥ç°æœ‰ç»“æ„ + å¢å¼ºåè®®
    - æ³¨æ„åŠ›åˆ·æ–°åè®® (å…³é”®!)
    - ERROR_LOG.md (å”¯ä¸€æ–°å¢æ ¸å¿ƒæ–‡ä»¶)
    - Manus æ–¹æ³•èå…¥ research/
    - Ralph å¾ªç¯ä¿æŒä¸å˜
```

### ä¸‰å¥è¯æ€»ç»“

1. **Ralph æä¾›æ‰§è¡ŒåŠ›**: Stop Hook ä¸è®©ä½ èµ°ï¼Œç›´åˆ°æ´»å¹²å®Œ
2. **æ³¨æ„åŠ›åˆ·æ–°é˜²é—å¿˜**: å…³é”®æ—¶åˆ»è¯»æ–‡ä»¶ï¼Œç›®æ ‡æ‹‰å›æ³¨æ„åŠ›
3. **ERROR_LOG ç•™ç—•è¿¹**: é”™è¯¯è®°å½•ä¸‹æ¥ï¼Œé¿å…é‡å¤è¸©å‘

---

**ä¸‹ä¸€æ­¥**: æ‰¹å‡†åä» Phase 1 (æ³¨æ„åŠ›åˆ·æ–°åè®®) å¼€å§‹å®æ–½ã€‚

---

*Generated by Claude Opus 4.5 | CC-DevFlow Upgrade Proposal v2.0*
