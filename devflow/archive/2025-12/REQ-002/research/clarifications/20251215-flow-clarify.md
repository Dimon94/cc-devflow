# Clarification Report: REQ-002

> Generated by: /flow-clarify
> Date: 2025-12-15
> Session ID: 20251215-REQ-002-clarify
> Questions: 4 / 4

---

## Summary

| Dimension | Status | Issues | Questions Asked |
|-----------|--------|--------|-----------------|
| Functional Scope & Behavior | ⚠️ Partial | 2 | 1 |
| Domain & Data Model | ⚠️ Partial | 1 | 0 |
| Interaction & UX Flow | ⚠️ Partial | 2 | 1 |
| Non-Functional | ✅ Clear | 0 | 0 |
| Integration | ✅ Clear | 0 | 0 |
| Edge Cases & Failure | ⚠️ Partial | 1 | 1 |
| Constraints & Tradeoffs | ✅ Clear | 0 | 0 |
| Terminology | ✅ Clear | 0 | 0 |
| Completion Signals | ⚠️ Partial | 1 | 1 |
| Placeholders | ✅ Clear | 0 | 0 |
| Security & Privacy | ✅ Clear | 0 | 0 |

**Overall Clarity Score**: 64% → 91% (after clarification)

---

## Clarification Log

### Q1: [Completion Signals] - Checklist 完成度计算逻辑

**歧义点**: Checklist 完成度 80% 如何计算？

**用户回答**: A - 全局计算

**澄清内容**:
- 完成度 = 所有 Checklist 类型的总 checked / total
- 不区分类型，统一计算
- 示例：ux.md (8/10) + api.md (6/10) = 14/20 = 70%

**更新规格**:
```yaml
gate_calculation:
  method: global
  formula: sum(checked) / sum(total)
  threshold: 0.8
```

---

### Q2: [Interaction & UX Flow] - Checklist 标记完成方式

**歧义点**: 用户如何标记 Checklist 项为完成？

**用户回答**: C - 混合模式

**澄清内容**:
- 默认：用户直接编辑 markdown `[ ]` → `[x]`
- 可选：命令批量操作 `/flow-checklist REQ-XXX --check CHK001,CHK002`
- 支持 `--uncheck` 反向操作

**更新规格**:
```yaml
interaction_mode:
  primary: manual_edit
  secondary: command_batch
  commands:
    - /flow-checklist REQ-XXX --check CHK001,CHK002
    - /flow-checklist REQ-XXX --uncheck CHK003
```

---

### Q3: [Edge Cases & Failure Handling] - 跳过门禁条件

**歧义点**: --skip-gate 跳过门禁的条件与审计要求？

**用户回答**: C - 审计日志

**澄清内容**:
- 必须提供 `--reason "紧急修复 xxx"`
- 记录到 `EXECUTION_LOG.md` 审计日志
- 格式：`[SKIP-GATE] timestamp | user | reason`

**更新规格**:
```yaml
skip_gate:
  require_reason: true
  audit_log: EXECUTION_LOG.md
  log_format: "[SKIP-GATE] {timestamp} | {reason}"
  warning_message: "⚠️ 门禁已跳过，原因已记录"
```

---

### Q4: [Functional Scope & Behavior] - 多类型 Checklist 支持

**歧义点**: 单次命令是否支持生成多种类型 Checklist？

**用户回答**: B - 多类型

**澄清内容**:
- 支持逗号分隔多类型：`--type ux,api,security`
- 每种类型生成独立文件：`checklists/ux.md`, `checklists/api.md`
- 默认类型：`general`（综合检查）

**更新规格**:
```yaml
checklist_types:
  supported: [ux, api, security, performance, data, general]
  default: general
  multi_type: true
  syntax: "--type type1,type2,type3"
  output_pattern: "checklists/{type}.md"
```

---

## Updated Decisions Summary

| ID | Decision | Source |
|----|----------|--------|
| R001 | 6 种 Checklist 类型 | research.md |
| R002 | 80% 质量门禁阈值 | research.md |
| R003 | Anti-Example 强制逻辑 | research.md |
| R004 | YAML 配置格式 | research.md |
| R005 | /flow-epic 入口门集成 | research.md |
| **C001** | **全局计算完成度** | **clarify Q1** |
| **C002** | **混合模式标记完成** | **clarify Q2** |
| **C003** | **跳过门禁需审计日志** | **clarify Q3** |
| **C004** | **支持多类型生成** | **clarify Q4** |

---

## Pending Clarifications

无待澄清项，所有关键歧义已解决。

---

## Next Command

✅ Run `/flow-prd` to generate PRD
